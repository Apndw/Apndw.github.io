import{d as D,z as F,p,B as Z,C as K,r as S,v as R,y as G,f as r,G as I,H as E,j as A,i,g as C,l as s,q as f,E as g,n as U}from"./index-BsES15Te.js";import{a as z,s as N}from"./navbar-U4Lqfhly.js";import{c as Y,a as B,T as L,b as P,f as o}from"./text.input-wRMa5HVC.js";var J=s('<span class="xl:text-xl font-semibold text-center">Kami mohon maaf, link yang kami sediakan tidak valid,<div class=divider></div>mohon kirimkan permintaan link baru untuk memproses permintaan perubahan password anda.'),Q=s('<div class="flex items-center justify-between">'),W=s('<button type=button class="btn btn-block btn-primary">Back'),X=s('<span class="xl:text-xl font-semibold">Please enter your new password below, and we will change your current password with new password.'),ee=s("<span>Submit"),te=s('<span class="loading loading-dots loading-lg">'),ae=s('<div class="w-full flex flex-col items-stretch gap-3"><label class="input input-bordered flex items-center gap-2"><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 16 16"fill=currentColor class="w-4 h-4 opacity-70"><path fill-rule=evenodd d="M14 6a4 4 0 0 1-4.899 3.899l-1.955 1.955a.5.5 0 0 1-.353.146H5v1.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-2.293a.5.5 0 0 1 .146-.353l3.955-3.955A4 4 0 1 1 14 6Zm-4-2a.75.75 0 0 0 0 1.5.5.5 0 0 1 .5.5.75.75 0 0 0 1.5 0 2 2 0 0 0-2-2Z"clip-rule=evenodd></path></svg></label><label class="input input-bordered flex items-center gap-2"><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 16 16"fill=currentColor class="w-4 h-4 opacity-70"><path fill-rule=evenodd d="M14 6a4 4 0 0 1-4.899 3.899l-1.955 1.955a.5.5 0 0 1-.353.146H5v1.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-2.293a.5.5 0 0 1 .146-.353l3.955-3.955A4 4 0 1 1 14 6Zm-4-2a.75.75 0 0 0 0 1.5.5.5 0 0 1 .5.5.75.75 0 0 0 1.5 0 2 2 0 0 0-2-2Z"clip-rule=evenodd></path></svg></label><div class="flex items-center justify-between"></div><button type=submit class="btn btn-block btn-primary"></button><div class="divider text-sm"></div><div class="w-full flex justify-center items-center gap-4"><button type=button class="btn btn-block dark:btn-neutral">Home'),re=s('<span class="xl:text-xl font-semibold">Mohon maaf, seprtinya terjadi kesalahan,<div class=divider></div>silahkan coba beberapa saat lagi atau hubungi admin.');function ie(){const l=D(),m=F(),[n,w]=p(!0),[b,T]=p(""),[v,h]=p(!1),[k,M]=p(""),t=Y({new_password:B("",{required:!0,validators:[o.required,o.minLength,o.maxLength]}),new_password_confirmation:B("",{required:!0,validators:[o.required,o.minLength,o.maxLength]})});Z(()=>{const{state:e,query:a}=K();if(!a||a==null||a==null){l("/",{replace:!0});return}if((a.otp==null||a.email==null)&&!e?.isOk){l("/",{replace:!0});return}if(!e||e==null||e==null&&!e?.isOk){l(`/forgot-password/verify/${m.id}`,{replace:!0,state:{otp:e.otp,email:e.email,isOk:!0}});return}T(e.otp),M(e.email),O()});const O=async()=>{await S.post({url:"public/forgot-password/check",name:"System",data:{email:k(),otp:b(),token:m?.id},server:R.AUTH,success:()=>{h(!0)},error:()=>{h(!1)},finally:()=>{w(!1)}})},q=()=>{if(t.isSubmitted){f("System","Formulir sudah dikirimkan",g.ERROR);return}if(!t.isValid){f("System","Silahkan isi semua formulir",g.ERROR);return}if(t.value.new_password!==t.value.new_password_confirmation){t.controls.new_password_confirmation.setErrors({notMatch:"tidak cocok dengan password"});return}t.markSubmitted(!0),w(!0),H()},H=async()=>{await S.patch({url:"public/forgot-password/verify",name:"Register",data:{email:k(),otp:b(),token:m?.id,new_password:t.value.new_password,new_password_confirmation:t.value.new_password_confirmation},server:R.AUTH,success:()=>{l("/forgot-password/done",{replace:!0,state:{isDone:!0}})},error:e=>{console.log(e),f("Forgot Password",e.message,g.ERROR)},finally:()=>{t.markSubmitted(!1),w(!1)}})};return G(e=>{t.isDirty&&!e.defaultPrevented&&(e.preventDefault(),setTimeout(()=>{N({title:"Apakah Anda yakin?",text:"Anda akan kehilangan data yang telah diisi!",icon:"warning",buttons:["Tidak","Ya"],dangerMode:!0}).then(a=>{a&&e.retry(!0)})},100))}),r(z,{get disabled(){return n()},title:"Lupa Password",get children(){return r(I,{get fallback(){return re()},get children(){return[r(E,{get when(){return!v()},get children(){return[J(),Q(),(()=>{var e=W();return e.$$click=()=>l("/login",{replace:!0}),A(()=>e.disabled=n()),e})()]}}),r(E,{get when(){return v()},get children(){return[X(),(()=>{var e=ae(),a=e.firstChild;a.firstChild;var c=a.nextSibling;c.firstChild;var _=c.nextSibling,d=_.nextSibling,V=d.nextSibling,j=V.nextSibling,x=j.firstChild;return i(a,r(L,{type:"password",name:"new_password",get disabled(){return n()},placeholder:"Password Baru",get control(){return t.controls.new_password},class:"grow input outline-none focus:outline-none border-none border-[0px] h-auto pl-1 pr-0"}),null),i(e,r(P,{name:"Password Baru",get control(){return t.controls.new_password}}),c),i(c,r(L,{type:"password",name:"new_password_confirmation",get disabled(){return n()},placeholder:"Konfirmasi Password Baru",get control(){return t.controls.new_password_confirmation},class:"grow input outline-none focus:outline-none border-none border-[0px] h-auto pl-1 pr-0"}),null),i(e,r(P,{name:"Konfirmasi Password Baru",get control(){return t.controls.new_password_confirmation}}),_),d.$$click=q,i(d,r(C,{get when(){return!n()},get children(){return ee()}}),null),i(d,r(C,{get when(){return n()},get children(){return te()}}),null),x.$$click=()=>l("/"),A(u=>{var y=n(),$=n();return y!==u.e&&(d.disabled=u.e=y),$!==u.t&&(x.disabled=u.t=$),u},{e:void 0,t:void 0}),e})()]}})]}})}})}U(["click"]);export{ie as default};
